<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wijnkelder Beheer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.9.0/sha256.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- Navigation Menu -->
        <nav id="mainNav" class="main-nav">
            <button class="nav-item active" data-view="collection" onclick="app.showCollection()">
                üç∑ Mijn Kelder
            </button>
            <button class="nav-item" data-view="statistics" onclick="app.showStatistics()">
                üìä Statistieken
            </button>
            <button class="nav-item" data-view="value" onclick="app.showValueDashboard()">
                üí∞ Voorraadwaarde
            </button>
            <button class="nav-item" data-view="locations" onclick="app.showLocations()">
                üìç Locaties
            </button>
            <button class="nav-item" data-view="activities" onclick="app.showActivities()">
                üì∞ Activiteiten
            </button>
            <button class="nav-item" data-view="users" onclick="app.showUsers()">
                üë• Gebruikers
            </button>
            <button class="nav-item" data-view="settings" onclick="app.showSettings()">
                ‚öôÔ∏è Instellingen
            </button>
        </nav>

        <!-- Wine Collection View -->
        <div id="collectionView" class="view">
            <header class="app-header">
                <h1>üç∑ Mijn Wijnkelder</h1>
                <div style="display: flex; align-items: center; gap: var(--space-12); flex-wrap: wrap;">
                    <div id="currentUserBadge" class="current-user-badge" onclick="app.logout()" title="Klik om uit te loggen">
                        <span>üë§ <span id="currentUserName">Laden...</span></span>
                    </div>
                    <div id="connectionStatus" class="connection-status" onclick="app.showApiConfig()" title="Klik om API instellingen te openen">
                        <span class="status-dot"></span>
                        <span class="status-text">Verbinden...</span>
                        <span class="api-url-display" style="font-size: var(--font-size-xs); color: var(--color-text-secondary); margin-left: var(--space-4);"></span>
                    </div>
                    <button class="btn btn--primary" onclick="app.showWineForm()">+ Nieuwe Wijn</button>
                </div>
            </header>
            
            <div class="filter-controls">
                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="all" onclick="app.setStockFilter('all')">Alle wijnen</button>
                    <button class="filter-btn" data-filter="in_stock" onclick="app.setStockFilter('in_stock')">In voorraad</button>
                    <button class="filter-btn" data-filter="out_of_stock" onclick="app.setStockFilter('out_of_stock')">Uit voorraad</button>
                </div>
                <div class="search-bar">
                    <input type="text" id="searchInput" class="form-control" placeholder="Zoek op naam, wijnhuis, streek, druif..." oninput="app.filterWines()">
                </div>
                <div class="user-filter-controls" style="margin-top: var(--space-12);">
                    <label class="checkbox-label" style="display: inline-flex; align-items: center; padding: var(--space-10) var(--space-16); cursor: pointer;">
                        <input type="checkbox" id="myWinesFilter" onchange="app.toggleMyWinesFilter()" style="margin-right: var(--space-8);">
                        <span>üë§ Alleen mijn wijnen tonen</span>
                    </label>
                </div>
            </div>

            <div id="wineGrid" class="wine-grid"></div>
        </div>

        <!-- Wine Form View (Add/Edit) -->
        <div id="wineFormView" class="view" style="display: none;">
            <header class="app-header">
                <button class="btn-back" onclick="app.showCollection()">‚Üê Terug</button>
                <h1 id="wineFormTitle">Nieuwe Wijn</h1>
            </header>
            
            <div class="form-container">
                <form id="wineForm" onsubmit="app.saveWine(event)">
                    <input type="hidden" id="wineId">
                    
                    <div class="form-group">
                        <label class="form-label">Naam *</label>
                        <input type="text" id="wineNaam" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Wijnhuis *</label>
                        <input type="text" id="wineWijnhuis" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Vintage *</label>
                        <input type="number" id="wineVintage" class="form-control" min="1900" max="2099" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Streek *</label>
                        <input type="text" id="wineStreek" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Druif *</label>
                        <input type="text" id="wineDruif" class="form-control" placeholder="Bijv. Chardonnay, Cabernet Sauvignon" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Kleur *</label>
                        <select id="wineKleur" class="form-control" required>
                            <option value="">Selecteer kleur</option>
                            <option value="Wit">Wit</option>
                            <option value="Ros√©">Ros√©</option>
                            <option value="Rood">Rood</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Locatie *</label>
                        <select id="wineLocatie" class="form-control" required>
                            <option value="">Selecteer locatie</option>
                            <option value="Kelder">Kelder</option>
                            <option value="Klimaatkast">Klimaatkast</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Aantal flessen *</label>
                        <input type="number" id="wineAantalFlessen" class="form-control" min="0" value="1" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Prijs per fles (‚Ç¨)</label>
                        <input type="number" id="winePrijs" class="form-control" min="0" step="0.01" placeholder="0.00">
                        <p class="form-helper">Optioneel - voor voorraadwaarde berekening</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Etiket foto</label>
                        <input type="file" id="winePhoto" class="form-control" accept="image/jpeg,image/png">
                        <p class="form-helper">Upload een foto van het etiket (JPG/PNG, max 2MB)</p>
                        <div id="photoPreview" style="margin-top: var(--space-12); display: none;">
                            <img id="photoPreviewImg" style="max-width: 200px; max-height: 200px; border-radius: var(--radius-base); border: 1px solid var(--color-border);">
                            <button type="button" class="btn btn--sm btn--outline" onclick="app.removePhoto()" style="margin-top: var(--space-8);">Verwijder foto</button>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn--secondary" onclick="app.showCollection()">Annuleren</button>
                        <button type="submit" class="btn btn--primary">Opslaan</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Wine Detail View -->
        <div id="wineDetailView" class="view" style="display: none;">
            <header class="app-header">
                <button class="btn-back" onclick="app.showCollection()">‚Üê Terug</button>
                <h1 id="wineDetailName"></h1>
            </header>
            
            <div class="detail-container">
                <div class="wine-info-card card">
                    <div class="card__body">
                        <div id="wineDetailInfo"></div>
                        <div class="wine-actions">
                            <button class="btn btn--secondary" onclick="app.editWine()">Bewerken</button>
                            <button class="btn btn--outline" onclick="app.deleteWine()">Verwijderen</button>
                        </div>
                    </div>
                </div>

                <div class="tasting-section">
                    <div class="section-header">
                        <h2>Proefnotities</h2>
                        <button class="btn btn--primary" onclick="app.showTastingForm()">+ Nieuwe Proefnotitie</button>
                    </div>
                    <div id="tastingNotesList"></div>
                </div>
            </div>
        </div>

        <!-- Tasting Form View -->
        <div id="tastingFormView" class="view" style="display: none;">
            <header class="app-header">
                <button class="btn-back" onclick="app.backFromTastingForm()">‚Üê Terug</button>
                <h1>Proefformulier</h1>
            </header>
            
            <div class="form-container">
                <form id="tastingForm" onsubmit="app.saveTastingNote(event)">
                    <input type="hidden" id="tastingId">
                    <input type="hidden" id="tastingWineId">
                    
                    <div class="form-group">
                        <label class="form-label">Datum</label>
                        <input type="date" id="tastingDatum" class="form-control" required>
                    </div>

                    <!-- Kleur Sectie -->
                    <div class="form-section">
                        <h3>üé® Kleur</h3>
                        
                        <div class="form-group">
                            <label class="form-label">Wijntype *</label>
                            <div class="radio-group wine-type-group">
                                <label class="radio-label wine-type-option">
                                    <input type="radio" name="wijntype" value="Wit" onchange="app.updateColorOptions()" required>
                                    <span class="wine-type-icon white">üç∑</span>
                                    <span>Wit</span>
                                </label>
                                <label class="radio-label wine-type-option">
                                    <input type="radio" name="wijntype" value="Ros√©" onchange="app.updateColorOptions()" required>
                                    <span class="wine-type-icon rose">üç∑</span>
                                    <span>Ros√©</span>
                                </label>
                                <label class="radio-label wine-type-option">
                                    <input type="radio" name="wijntype" value="Rood" onchange="app.updateColorOptions()" required>
                                    <span class="wine-type-icon red">üç∑</span>
                                    <span>Rood</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group" id="colorOptionsGroup" style="display: none;">
                            <label class="form-label">Kleur *</label>
                            <div id="colorOptions" class="radio-group"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Intensiteit (visueel) *</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="intensiteit" value="Laag" required>
                                    <span>üíß Laag</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="intensiteit" value="Medium" required>
                                    <span>üíßüíß Medium</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="intensiteit" value="Hoog" required>
                                    <span>üíßüíßüíß Hoog</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Geur Sectie -->
                    <div class="form-section">
                        <h3>üå∏ Geur</h3>
                        
                        <div class="form-group">
                            <label class="form-label">Intensiteit *</label>
                            <div class="radio-group">
                                <label class="radio-label intensity-option">
                                    <input type="radio" name="geurintensiteit" value="Laag" required>
                                    <span>üìä Laag</span>
                                </label>
                                <label class="radio-label intensity-option">
                                    <input type="radio" name="geurintensiteit" value="Medium" required>
                                    <span>üìäüìä Medium</span>
                                </label>
                                <label class="radio-label intensity-option">
                                    <input type="radio" name="geurintensiteit" value="Hoog" required>
                                    <span>üìäüìäüìä Hoog</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Primair</label>
                            <div class="checkbox-grid">
                                <label class="checkbox-label aroma-option">
                                    <input type="checkbox" name="geur_primair" value="Citrus" onchange="app.updateStarCalculation()">
                                    <span>üçã Citrus</span>
                                </label>
                                <label class="checkbox-label aroma-option">
                                    <input type="checkbox" name="geur_primair" value="Boomvruchten" onchange="app.updateStarCalculation()">
                                    <span>üçé Boomvruchten</span>
                                </label>
                                <label class="checkbox-label aroma-option">
                                    <input type="checkbox" name="geur_primair" value="Steenfruit" onchange="app.updateStarCalculation()">
                                    <span>üçë Steenfruit</span>
                                </label>
                                <label class="checkbox-label aroma-option">
                                    <input type="checkbox" name="geur_primair" value="Tropisch fruit" onchange="app.updateStarCalculation()">
                                    <span>üçç Tropisch fruit</span>
                                </label>
                                <label class="checkbox-label aroma-option">
                                    <input type="checkbox" name="geur_primair" value="Rood fruit" onchange="app.updateStarCalculation()">
                                    <span>üçì Rood fruit</span>
                                </label>
                                <label class="checkbox-label aroma-option">
                                    <input type="checkbox" name="geur_primair" value="Donker fruit" onchange="app.updateStarCalculation()">
                                    <span>ü´ê Donker fruit</span>
                                </label>
                                <label class="checkbox-label aroma-option">
                                    <input type="checkbox" name="geur_primair" value="Bloemen" onchange="app.updateStarCalculation()">
                                    <span>üå∏ Bloemen</span>
                                </label>
                                <label class="checkbox-label aroma-option">
                                    <input type="checkbox" name="geur_primair" value="Kruiden" onchange="app.updateStarCalculation()">
                                    <span>üåø Kruiden</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Secundair</label>
                            <div class="checkbox-grid">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="geur_secundair" value="Brood/gistachtig" onchange="app.updateStarCalculation()">
                                    <span>Brood/gistachtig</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="geur_secundair" value="Houtrijping" onchange="app.updateStarCalculation()">
                                    <span>Houtrijping</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Tertiair</label>
                            <div class="checkbox-grid">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="geur_tertiair" value="Evolutie (chocolade, paddestoel, etc.)" onchange="app.updateStarCalculation()">
                                    <span>Evolutie (chocolade, paddestoel, etc.)</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Mouthfeel Sectie -->
                    <div class="form-section">
                        <h3>üëÑ Mouthfeel</h3>
                        
                        <div class="form-group">
                            <label class="form-label">Droog</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="droog" value="0" required>
                                    <span>Heel droog (0)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="droog" value="1" required>
                                    <span>Droog (1)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="droog" value="2" required>
                                    <span>Halfzoet (2)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="droog" value="3" required>
                                    <span>Zoet (3)</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Tannines</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="tannines" value="0" required>
                                    <span>Niet aanwezig (0)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="tannines" value="1" required>
                                    <span>Laag (1)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="tannines" value="2" required>
                                    <span>Medium (2)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="tannines" value="3" required>
                                    <span>Hoog (3)</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Zuur</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="zuur" value="1" required>
                                    <span>Laag (1)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="zuur" value="2" required>
                                    <span>Medium (2)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="zuur" value="3" required>
                                    <span>Hoog (3)</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Alcohol</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="alcohol" value="1" required>
                                    <span>Laag (1)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="alcohol" value="2" required>
                                    <span>Medium (2)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="alcohol" value="3" required>
                                    <span>Hoog (3)</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Body</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="body" value="Laag" required>
                                    <span>Laag</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="body" value="Medium" required>
                                    <span>Medium</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="body" value="Hoog" required>
                                    <span>Hoog</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Afdronk</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="afdronk" value="Laag" onchange="app.updateStarCalculation()" required>
                                    <span>‚è±Ô∏è Laag</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="afdronk" value="Medium" onchange="app.updateStarCalculation()" required>
                                    <span>‚è±Ô∏è‚è±Ô∏è Medium</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="afdronk" value="Hoog" onchange="app.updateStarCalculation()" required>
                                    <span>‚è±Ô∏è‚è±Ô∏è‚è±Ô∏è Hoog</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Beoordeling -->
                    <div class="form-section beoordeling-section">
                        <h3>‚≠ê Beoordeling</h3>
                        
                        <div id="automaticStarsDisplay" class="automatic-stars-display">
                            <div class="stars-preview">
                                <div id="starPreview" class="star-preview-large"></div>
                            </div>
                            <div id="starExplanation" class="star-explanation"></div>
                        </div>

                        <div class="form-group manual-stars-group" id="manualStarsGroup" style="display: none;">
                            <label class="form-label">Handmatige sterren (optioneel)</label>
                            <p class="form-helper">Je kunt maximaal 3 hele sterren (6 halve sterren) handmatig toevoegen aan de automatische sterren</p>
                            
                            <div class="manual-star-item">
                                <label class="checkbox-label manual-star-checkbox">
                                    <input type="checkbox" name="manual_star_1" onchange="app.updateStarCalculation()">
                                    <span class="manual-star-icon">‚≠ê Handmatige ster 1</span>
                                </label>
                                <div class="form-group" id="manualReason1Group" style="display: none; margin-top: 8px;">
                                    <label class="form-label">Waarom deze ster?</label>
                                    <textarea id="manualReason1" class="form-control" rows="2" placeholder="Bijv. Uitzonderlijke complexiteit..."></textarea>
                                </div>
                            </div>
                            
                            <div class="manual-star-item">
                                <label class="checkbox-label manual-star-checkbox">
                                    <input type="checkbox" name="manual_star_2" onchange="app.updateStarCalculation()">
                                    <span class="manual-star-icon">‚≠ê Handmatige ster 2</span>
                                </label>
                                <div class="form-group" id="manualReason2Group" style="display: none; margin-top: 8px;">
                                    <label class="form-label">Waarom deze ster?</label>
                                    <textarea id="manualReason2" class="form-control" rows="2" placeholder="Bijv. Perfecte balans..."></textarea>
                                </div>
                            </div>
                            
                            <div class="manual-star-item">
                                <label class="checkbox-label manual-star-checkbox">
                                    <input type="checkbox" name="manual_star_3" onchange="app.updateStarCalculation()">
                                    <span class="manual-star-icon">‚≠ê Handmatige ster 3</span>
                                </label>
                                <div class="form-group" id="manualReason3Group" style="display: none; margin-top: 8px;">
                                    <label class="form-label">Waarom deze ster?</label>
                                    <textarea id="manualReason3" class="form-control" rows="2" placeholder="Bijv. Zeldzame kwaliteit..."></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Notities</label>
                            <textarea id="tastingNotities" class="form-control" rows="4" placeholder="Aanvullende opmerkingen..."></textarea>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn--secondary" onclick="app.backFromTastingForm()">Annuleren</button>
                        <button type="submit" class="btn btn--primary">Opslaan</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Locations Management View -->
        <div id="locationsView" class="view" style="display: none;">
            <header class="app-header">
                <h1>üìç Locaties Beheren</h1>
                <button class="btn btn--primary" onclick="app.showLocationForm()">+ Nieuwe Locatie</button>
            </header>
            
            <div class="locations-container">
                <div id="locationsList" class="locations-list"></div>
            </div>
        </div>

        <!-- Location Form Modal -->
        <div id="locationFormModal" class="modal" style="display: none;">
            <div class="modal-backdrop" onclick="app.closeLocationForm()"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="locationFormTitle">Nieuwe Locatie</h2>
                    <button class="btn-close" onclick="app.closeLocationForm()" aria-label="Sluiten">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="locationForm" onsubmit="app.saveLocation(event)">
                        <input type="hidden" id="locationId">
                        <div class="form-group">
                            <label class="form-label">Naam *</label>
                            <input type="text" id="locationName" class="form-control" placeholder="Bijv. Kelder, Klimaatkast, Wijnkast" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Temperatuur (¬∞C)</label>
                            <input type="number" id="locationTemperature" class="form-control" placeholder="12" min="0" max="30" step="0.5">
                            <p class="form-helper" style="margin-top: var(--space-8); font-size: var(--font-size-sm); color: var(--color-text-secondary);">Optioneel - aanbevolen: 10-18¬∞C</p>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn--secondary" onclick="app.closeLocationForm()">Annuleren</button>
                            <button type="submit" class="btn btn--primary">Opslaan</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Statistics View -->
        <div id="statisticsView" class="view" style="display: none;">
            <header class="app-header">
                <h1>üìä Statistieken per Locatie</h1>
            </header>
            
            <div id="statisticsContainer" class="statistics-container"></div>
        </div>

        <!-- Value Dashboard View -->
        <div id="valueDashboardView" class="view" style="display: none;">
            <header class="app-header">
                <h1>üí∞ Voorraadwaarde</h1>
            </header>
            <div id="valueDashboardContainer" class="value-dashboard-container"></div>
        </div>

        <!-- Users View -->
        <div id="usersView" class="view" style="display: none;">
            <header class="app-header">
                <h1>üë• Gebruikers</h1>
                <div id="usersHeaderActions"></div>
            </header>
            <div id="usersContainer" class="users-container"></div>
        </div>

        <!-- Settings View -->
        <div id="settingsView" class="view" style="display: none;">
            <header class="app-header">
                <h1>‚öôÔ∏è Instellingen</h1>
            </header>
            <div class="settings-container">
                <div class="settings-section">
                    <h3>Database Export</h3>
                    <p>Maak een backup van je wijnkelder database</p>
                    <div style="display: flex; gap: var(--space-12); margin-top: var(--space-16); flex-wrap: wrap;">
                        <button class="btn btn--primary" onclick="app.exportJSON()">üíæ Download JSON</button>
                        <button class="btn btn--secondary" onclick="app.exportWinesCSV()">üìÑ Export Wijnen (CSV)</button>
                        <button class="btn btn--secondary" onclick="app.exportTastingsCSV()">üìÑ Export Proefnotities (CSV)</button>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>API Configuratie</h3>
                    <p>Beheer de verbinding met je JSON Server database</p>
                    <button class="btn btn--secondary" onclick="app.showApiConfig()" style="margin-top: var(--space-16);">‚öôÔ∏è Open API Instellingen</button>
                </div>
                
                <div class="settings-section">
                    <h3>Wachtwoord wijzigen</h3>
                    <p>Wijzig je persoonlijke wachtwoord</p>
                    <form id="changePasswordForm" onsubmit="app.changeOwnPassword(event)" style="margin-top: var(--space-16);">
                        <div class="form-group">
                            <label class="form-label">Huidig wachtwoord</label>
                            <input type="password" id="currentPassword" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Nieuw wachtwoord (min. 6 karakters)</label>
                            <input type="password" id="newPassword" class="form-control" required minlength="6">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Bevestig nieuw wachtwoord</label>
                            <input type="password" id="confirmPassword" class="form-control" required minlength="6">
                        </div>
                        <button type="submit" class="btn btn--primary">Wijzig wachtwoord</button>
                    </form>
                </div>
                
                <div class="settings-section">
                    <h3>Sessie</h3>
                    <p>Log uit en wissel van gebruiker</p>
                    <button class="btn btn--outline" onclick="app.logout()" style="margin-top: var(--space-16);">üö™ Uitloggen</button>
                </div>
                
                <div class="settings-section">
                    <h3>Over</h3>
                    <p><strong>Wijnkelder Beheer v2.0</strong></p>
                    <p>Een complete oplossing voor het beheren van je wijnverzameling</p>
                </div>
            </div>
        </div>

        <!-- Activity Feed View -->
        <div id="activitiesView" class="view" style="display: none;">
            <header class="app-header">
                <h1>üì∞ Activiteiten Feed</h1>
            </header>
            <div id="activitiesContainer" class="activities-container"></div>
        </div>

        <!-- View Other User's Kelder -->
        <div id="viewUserKelderView" class="view" style="display: none;">
            <header class="app-header">
                <button class="btn-back" onclick="app.showUsers()">‚Üê Terug naar gebruikers</button>
                <h1 id="viewUserKelderTitle">Wijnkelder van Gebruiker</h1>
            </header>
            <div id="viewUserKelderContainer" class="view-user-kelder-container"></div>
        </div>

        <!-- Extensions View -->
        <div id="extensionsView" class="view" style="display: none;">
            <header class="app-header">
                <h1>üí° Mogelijke Uitbreidingen</h1>
            </header>
            
            <div class="extensions-container">
                <p class="extensions-intro">Hier zijn enkele idee√´n voor toekomstige functies die de wijnkelder app nog beter kunnen maken:</p>
                
                <div class="extension-card">
                    <h3>üí∞ Wijnprijs Tracking</h3>
                    <p>Voeg kostprijs per fles toe en bereken de totale voorraadwaarde. Krijg inzicht in je investering.</p>
                </div>
                
                <div class="extension-card">
                    <h3>üìÖ Drinkingwindow Calculator</h3>
                    <p>Automatische berekening van optimale drinkperiode: "Deze wijn is gereed om te drinken: 2025-2030"</p>
                </div>
                
                <div class="extension-card">
                    <h3>‚è∞ Automatische Proef-reminders</h3>
                    <p>Ontvang meldingen wanneer het tijd is om bepaalde wijnen te proeven of te drinken.</p>
                </div>
                
                <div class="extension-card">
                    <h3>üçΩÔ∏è Wijn &amp; Voedsel Matching</h3>
                    <p>"Aanbevolen met..." - match wijnen met gerechten en evenementen voor perfecte combinaties.</p>
                </div>
                
                <div class="extension-card">
                    <h3>üè¢ Producent/Wijnhuis Database</h3>
                    <p>Koppeling naar externe informatie over wijnhuizen, hun geschiedenis en andere wijnen.</p>
                </div>
                
                <div class="extension-card">
                    <h3>üì∏ Foto's van Etiketten</h3>
                    <p>Voeg foto's van etiketten en flessen toe voor visuele herkenning en herinneringen.</p>
                </div>
                
                <div class="extension-card">
                    <h3>üëÉ Voorkeurs-aroma's Tracking</h3>
                    <p>Ontdek welke aroma's je het meest waardeert en krijg gepersonaliseerde aanbevelingen.</p>
                </div>
                
                <div class="extension-card">
                    <h3>üóìÔ∏è Wijnroute Planning</h3>
                    <p>Plan welke wijnen je op welke data wilt drinken voor speciale gelegenheden.</p>
                </div>
                
                <div class="extension-card">
                    <h3>ü§ù Delen met Vrienden</h3>
                    <p>Deel proefnotities en aanbevelingen met andere wijnliefhebbers.</p>
                </div>
                
                <div class="extension-card">
                    <h3>üè∑Ô∏è Label Generator</h3>
                    <p>Print professionele labels voor kasten en planken met wijninfo.</p>
                </div>
                
                <div class="extension-card">
                    <h3>üì± Mobile App Versie</h3>
                    <p>Native app voor iOS en Android voor toegang onderweg.</p>
                </div>
                
                <div class="extension-card">
                    <h3>üíæ Backup &amp; Restore</h3>
                    <p>One-click backup en herstel van je complete wijnkelder database.</p>
                </div>
                
                <div class="extension-card">
                    <h3>üë• Multi-user Support</h3>
                    <p>Meerdere gebruikers kunnen tegelijk wijnen toevoegen en beheren.</p>
                </div>
            </div>
        </div>

        <!-- Tasting Note Detail View -->
        <div id="tastingDetailView" class="view" style="display: none;">
            <header class="app-header">
                <button class="btn-back" onclick="app.backToWineDetail()">‚Üê Terug</button>
                <h1>Proefnotitie</h1>
            </header>
            
            <div class="detail-container">
                <div class="tasting-detail-card card">
                    <div class="card__body">
                        <div id="tastingDetailContent"></div>
                        <div class="wine-actions">
                            <button class="btn btn--secondary" onclick="app.editTastingNote()">Bewerken</button>
                            <button class="btn btn--outline" onclick="app.deleteTastingNote()">Verwijderen</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal" style="display: none;">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîê Inloggen</h2>
            </div>
            <div class="modal-body">
                <form id="loginForm" onsubmit="app.handleLogin(event)">
                    <div class="form-group">
                        <label class="form-label">Gebruiker</label>
                        <select id="loginUsername" class="form-control" required>
                            <option value="">Selecteer gebruiker</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Wachtwoord</label>
                        <input type="password" id="loginPassword" class="form-control" required placeholder="Voer wachtwoord in">
                    </div>
                    <div id="loginError" style="display: none; padding: var(--space-12); background: rgba(var(--color-error-rgb), 0.1); color: var(--color-error); border-radius: var(--radius-base); margin-bottom: var(--space-16);"></div>
                    <button type="submit" class="btn btn--primary btn--full-width">Inloggen</button>
                </form>
            </div>
        </div>
    </div>

    <!-- User Form Modal -->
    <div id="userFormModal" class="modal" style="display: none;">
        <div class="modal-backdrop" onclick="app.closeUserForm()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="userFormTitle">Nieuwe Gebruiker</h2>
                <button class="btn-close" onclick="app.closeUserForm()" aria-label="Sluiten">&times;</button>
            </div>
            <div class="modal-body">
                <form id="userForm" onsubmit="app.saveUser(event)">
                    <input type="hidden" id="userId">
                    <div class="form-group">
                        <label class="form-label">Naam *</label>
                        <input type="text" id="userName" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" id="userEmail" class="form-control">
                    </div>
                    <div class="form-group" id="userPasswordGroup" style="display: none;">
                        <label class="form-label">Wachtwoord (min. 6 karakters)</label>
                        <input type="password" id="userPassword" class="form-control" minlength="6">
                        <p class="form-helper" style="margin-top: var(--space-8); font-size: var(--font-size-sm); color: var(--color-text-secondary);">Alleen invullen voor nieuwe gebruikers of om wachtwoord te wijzigen</p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Kleur *</label>
                        <div class="color-picker">
                            <label class="color-option-label">
                                <input type="radio" name="userColor" value="#e74c3c" required>
                                <span class="color-swatch" style="background: #e74c3c;"></span>
                            </label>
                            <label class="color-option-label">
                                <input type="radio" name="userColor" value="#3498db" required>
                                <span class="color-swatch" style="background: #3498db;"></span>
                            </label>
                            <label class="color-option-label">
                                <input type="radio" name="userColor" value="#2ecc71" required>
                                <span class="color-swatch" style="background: #2ecc71;"></span>
                            </label>
                            <label class="color-option-label">
                                <input type="radio" name="userColor" value="#f39c12" required>
                                <span class="color-swatch" style="background: #f39c12;"></span>
                            </label>
                            <label class="color-option-label">
                                <input type="radio" name="userColor" value="#9b59b6" required>
                                <span class="color-swatch" style="background: #9b59b6;"></span>
                            </label>
                            <label class="color-option-label">
                                <input type="radio" name="userColor" value="#1abc9c" required>
                                <span class="color-swatch" style="background: #1abc9c;"></span>
                            </label>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn--secondary" onclick="app.closeUserForm()">Annuleren</button>
                        <button type="submit" class="btn btn--primary">Opslaan</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Offline Mode Modal -->
    <div id="offlineModeModal" class="modal" style="display: none;">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ö†Ô∏è Geen verbinding met database</h2>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: var(--space-20);">Kan geen verbinding maken met de database. Wil je doorgaan met voorbeeldgegevens?</p>
                <div class="modal-actions">
                    <button class="btn btn--secondary" onclick="app.retryConnection()">üîÑ Probeer opnieuw</button>
                    <button class="btn btn--primary" onclick="app.loadDummyData()">üìã Laad voorbeeldgegevens</button>
                </div>
            </div>
        </div>
    </div>

    <!-- API Configuration Modal -->
    <div id="apiConfigModal" class="modal" style="display: none;">
        <div class="modal-backdrop" onclick="app.closeApiConfig()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è API Configuratie</h2>
                <button class="btn-close" onclick="app.closeApiConfig()" aria-label="Sluiten">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">API Base URL</label>
                    <input type="text" id="apiUrlInput" class="form-control" placeholder="http://localhost:3001" value="http://localhost:3001">
                    <p class="form-helper" style="margin-top: var(--space-8); font-size: var(--font-size-sm); color: var(--color-text-secondary);">
                        Voer de URL in waar JSON Server draait. Standaard: http://localhost:3001
                    </p>
                </div>
                
                <div id="connectionTestResult" style="display: none; padding: var(--space-16); border-radius: var(--radius-base); margin-top: var(--space-16);"></div>
                
                <div class="modal-actions">
                    <button class="btn btn--secondary" onclick="app.testApiConnection()">üîç Test Verbinding</button>
                    <button class="btn btn--primary" onclick="app.saveApiConfig()">Opslaan &amp; Herladen</button>
                </div>
                
                <div style="margin-top: var(--space-24); padding: var(--space-16); background: var(--color-bg-2); border-radius: var(--radius-base);">
                    <h4 style="margin-bottom: var(--space-12);">üí° Veelvoorkomende URLs:</h4>
                    <button class="btn btn--sm btn--outline" onclick="document.getElementById('apiUrlInput').value='http://localhost:3001'" style="margin-right: var(--space-8); margin-bottom: var(--space-8);">localhost:3001</button>
                    <button class="btn btn--sm btn--outline" onclick="document.getElementById('apiUrlInput').value='http://127.0.0.1:3001'" style="margin-right: var(--space-8); margin-bottom: var(--space-8);">127.0.0.1:3001</button>
                    <button class="btn btn--sm btn--outline" onclick="document.getElementById('apiUrlInput').value='http://'+window.location.hostname+':3001'" style="margin-bottom: var(--space-8);">Huidige host:3001</button>
                </div>
                
                <div style="margin-top: var(--space-16); padding: var(--space-16); background: var(--color-secondary); border-radius: var(--radius-base); font-size: var(--font-size-sm);">
                    <strong>Setup instructies:</strong><br>
                    1. Maak een db.json bestand met:<br>
                    <code style="background: var(--color-surface); padding: 2px 6px; border-radius: 4px; display: block; margin: 8px 0; white-space: pre; overflow-x: auto;">{"wines": [], "tastingNotes": [], "locations": [{"id": 1, "name": "Kelder"}, {"id": 2, "name": "Klimaatkast"}], "users": [], "activities": [], "comments": []}</code>
                    2. Start JSON Server: <code style="background: var(--color-surface); padding: 2px 6px; border-radius: 4px;">json-server --watch db.json --port 3001</code><br>
                    <strong style="color: var(--color-primary); margin-top: 8px; display: block;">Let op:</strong> Zorg dat "activities" en "comments" tabellen bestaan voor persistente activity feed!
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>